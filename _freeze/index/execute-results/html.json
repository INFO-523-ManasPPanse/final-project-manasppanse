{
  "hash": "2b12c5534a33bc5efb8b2461622f558b",
  "result": {
    "engine": "knitr",
    "markdown": "  ---\ntitle: \"Geopolitical Risk Analysis using CART\"\nauthors:\n  - name: \"Manas P Panse\"\n    affiliations: \"College of Information Science, University of Arizona\"\ndescription: \"A panoramic overview & analysis of the relationships between various economic, political, social factors and geopolitical stability.\"\nformat:\n   html:\n    code-fold: true\n    code-tools: true\n    code-overflow: wrap\n    embed-resources: true\neditor: visual\ncode-annotations: hover\nexecute:\n  warning: false\n  messae: false\n  error: false\ntoc: true\n\n---\n\n# 0 - Introduction & Workspace Setup\n\nThis project aims to classify countries based on their geopolitical risk using Classification and Regression Trees (CART) with indicators from the World Bank and other sources. We will explore the relationships between various economic, political, and social indicators and geopolitical stability.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot Theme\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 14))\n\n# Set Width of Code Output\noptions(width = 65)\n\n# Set Figure Parameters for knitr\nknitr::opts_chunk$set(\n  fig.width = 7,        # 7\" Width\n  fig.asp = 0.618,      # The Golden Ratio\n  fig.retina = 3,       # DPI Multiplier for Displaying HTML Output on Retina\n  fig.align = \"center\", # Center Align Figures\n  dpi = 300             # Higher DPI, Sharper Image\n)\n\n# Loading Packages\npacman::p_load(\"dplyr\", \"gsubfn\", \"here\", \"knitr\", \"tidyr\", \"stringr\", \"tidyverse\", \"scales\", \"cowplot\")\npacman::p_load(\"rworldmap\", \"rworldxtra\", \"maps\", \"ggplot2\", \"patchwork\", \"gtable\", \"gt\", \"gridExtra\")\npacman::p_load(\"rpart\", \"rpart.plot\")\n\n# Loading Necessary Datasets\ngdp_data <- read.csv(here(\"data/global_gdp.csv\"))\npollution_data <- read.csv(here(\"data/global_pollution.csv\"))\ndefense_data <- read.csv(here(\"data/global_military_expense.csv\"))\npolitical_data <- read.csv(here(\"data/global_political_stability.csv\"))\n\n# Highliting Countries of Interest\ncoi <- c(\"United States\", \"China\", \"Germany\", \"Japan\", \"India\")\n\n# Assigning Colors to Each Country\ncountry_colors <- c(\n  \"United States\" = \"blue\",\n  \"China\" = \"red\",\n  \"Germany\" = \"green\",\n  \"Japan\" = \"purple\",\n  \"India\" = \"orange\"\n)\n\noptions(scipen = 999)\n\n# Cleaning Column Names FOR All Datasets\ncolnames(gdp_data) <- gsub(\"^X\", \"\", colnames(gdp_data))\ncolnames(gdp_data) <- gsub(\"\\\\.\", \"\", colnames(gdp_data))\n\ncolnames(pollution_data) <- gsub(\"^X\", \"\", colnames(pollution_data))\ncolnames(pollution_data) <- gsub(\"\\\\.\", \"\", colnames(pollution_data))\n\ncolnames(defense_data) <- gsub(\"^X\", \"\", colnames(defense_data))\ncolnames(defense_data) <- gsub(\"\\\\.\", \"\", colnames(defense_data))\n\ncolnames(political_data) <- gsub(\"^X\", \"\", colnames(political_data))\ncolnames(political_data) <- gsub(\"\\\\.\", \"\", colnames(political_data))\n\n# Convert the relevant columns to numeric, skipping the first column (Country Names)\ngdp_data <- gdp_data %>%\n  mutate(across(-CountryName, ~ as.numeric(.)))\n\npollution_data <- pollution_data %>%\n  mutate(across(-CountryName, ~ as.numeric(.)))\n\ndefense_data <- defense_data %>%\n  mutate(across(-CountryName, ~ as.numeric(.)))\n\npolitical_data <- political_data %>%\n  mutate(across(-CountryName, ~ as.numeric(.)))\n\n# Reshaping into Long Format\ngdp_long <- gdp_data %>%\n  pivot_longer(\n    cols = -CountryName,\n    names_to = \"Year\",\n    values_to = \"GDP\"\n  )\n\npollution_long <- pollution_data %>%\n  pivot_longer(\n    cols = -CountryName,\n    names_to = \"Year\",\n    values_to = \"Pollution Level\"\n  )\n\ndefense_long <- defense_data %>%\n  pivot_longer(\n    cols = -CountryName,\n    names_to = \"Year\",\n    values_to = \"Expenditure\"\n  )\n\npolitical_long <- political_data %>%\n  pivot_longer(\n    cols = -CountryName,\n    names_to = \"Year\",\n    values_to = \"Ranking\"\n  )\n\n# Ensuring values are `numeric` In All Datasets\ngdp_long <- gdp_long %>%\n  filter(CountryName %in% coi, !is.na(Year), !is.na(GDP)) %>%\n  mutate(Year = as.numeric(as.character(Year))) %>%\n  mutate(GDP = as.numeric(as.character(GDP)))\n\npollution_long <- pollution_long %>%\n  filter(CountryName %in% coi, !is.na(Year), !is.na(`Pollution Level`)) %>%\n  mutate(Year = as.numeric(as.character(Year)))\n\ndefense_long <- defense_long %>%\n  filter(CountryName %in% coi, !is.na(Year), !is.na(Expenditure)) %>%\n  mutate(Year = as.numeric(as.character(Year))) %>%\n  mutate(Expenditure = as.numeric(as.character(Expenditure)))\n\npolitical_long <- political_long %>%\n  filter(CountryName %in% coi, !is.na(Year), !is.na(Ranking)) %>%\n  mutate(Year = as.numeric(as.character(Year)))\n\n# Creating a MEGASET for Future Use & Rearranging Da\ncombined_long <- gdp_long %>%\n  inner_join(pollution_long, by = c(\"CountryName\", \"Year\")) %>%\n  inner_join(defense_long, by = c(\"CountryName\", \"Year\")) %>%\n  inner_join(political_long, by = c(\"CountryName\", \"Year\")) %>%\n  na.omit()\n```\n:::\n\n# 1 - The BIG 5 Trends\n\n## A - Defense\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncombined_long %>%\n  ggplot(aes(x = Year, y = Expenditure / 1000000000, color = fct_relevel(CountryName, coi))) +\n  geom_smooth(se = FALSE) +\n  theme_bw() +\n  labs(\n    title = \"Military Expenditure Trends (2010 - 2019)\",\n    x = \"Year\", y = \"GDP\", color = \"Country\",\n    caption = \"GDP Data Collected from: World Bank Development Data Group -> World Bank Open Data\"\n  ) +\n  scale_color_manual(values = country_colors) +\n  scale_x_continuous(breaks = c(2010, 2012, 2014, 2016, 2018)) +\n  theme(\n    plot.title = element_text(size = 12.5, hjust = 0.5),\n    plot.subtitle = element_text(size = 7.5, hjust = 0.5),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 7.5),\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/defense-trend-1.png){fig-align='center' width=2100}\n:::\n:::\n\n## B - GDP\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncombined_long %>%\n  ggplot(aes(x = Year, y = GDP / 1000000000, color = fct_relevel(CountryName, coi))) +\n  geom_smooth(se = FALSE) +\n  theme_bw() +\n  labs(\n    title = \"GDP Trends (2010 - 2019)\",\n    x = \"Year\", y = \"GDP\", color = \"Country\",\n    caption = \"GDP Data Collected from: World Bank Development Data Group -> World Bank Open Data\"\n  ) +\n  scale_color_manual(values = country_colors) +\n  scale_x_continuous(breaks = c(2010, 2012, 2014, 2016, 2018)) +\n  theme(\n    plot.title = element_text(size = 12.5, hjust = 0.5),\n    plot.subtitle = element_text(size = 7.5, hjust = 0.5),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 7.5),\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/gdp-trend-1.png){fig-align='center' width=2100}\n:::\n:::\n\n## C - Political Stability\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncombined_long %>%\n  ggplot(aes(x = Year, y = Ranking, color = fct_relevel(CountryName, coi))) +\n  geom_smooth(se = FALSE) +\n  theme_bw() +\n  labs(\n    title = \"Political Stability Trends (2010 - 2019)\",\n    x = \"Year\", y = \"GDP\", color = \"Country\",\n    caption = \"GDP Data Collected from: World Bank Development Data Group -> World Bank Open Data\"\n  ) +\n  scale_color_manual(values = country_colors) +\n  scale_x_continuous(breaks = c(2010, 2012, 2014, 2016, 2018)) +\n  theme(\n    plot.title = element_text(size = 12.5, hjust = 0.5),\n    plot.subtitle = element_text(size = 7.5, hjust = 0.5),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 7.5),\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/political-stability-trend-1.png){fig-align='center' width=2100}\n:::\n:::\n\n## D - Pollution\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncombined_long %>%\n  ggplot(aes(x = Year, y = `Pollution Level`, color = fct_relevel(CountryName, coi))) +\n  geom_smooth(se = FALSE) +\n  theme_bw() +\n  labs(\n    title = \"Pollution Trends (2010 - 2019)\",\n    x = \"Year\", y = \"GDP\", color = \"Country\",\n    caption = \"GDP Data Collected from: World Bank Development Data Group -> World Bank Open Data\"\n  ) +\n  scale_color_manual(values = country_colors) +\n  scale_x_continuous(breaks = c(2010, 2012, 2014, 2016, 2018)) +\n  theme(\n    plot.title = element_text(size = 12.5, hjust = 0.5),\n    plot.subtitle = element_text(size = 7.5, hjust = 0.5),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 7.5),\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/pollution-trend-1.png){fig-align='center' width=2100}\n:::\n:::\n\n# 2 - CART Analysis\n\n## A - Political Stability & Military Expenditure\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# CART Model for GDP based on Poitical Stability, Pollution Levels and Military Expenditure\npolitical_stability_cart <- rpart(Ranking ~ Expenditure, data = combined_long, method = \"anova\")\n\n# Plotting CART Model\nrpart.plot(\n  political_stability_cart,\n  main = \"CART Model - Political Stability vs Military Expenditure\",\n  type = 3, digits = -2, varlen = 0, faclen = 0, fallen.leaves = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/politicalstability-vs-militaryexpenditure-1.png){fig-align='center' width=2100}\n:::\n:::\n\n## B - Political Stability & Pollution Levels\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# CART Model for GDP based on Poitical Stability, Pollution Levels and Military Expenditure\npolitical_stability_cart <- rpart(Ranking ~ `Pollution Level`, data = combined_long, method = \"anova\")\n\n# Plotting CART Model\nrpart.plot(political_stability_cart, main = \"CART Model - Political Stability vs Pollution Level & Military\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/politicalstability-vs-pollutionlevels-1.png){fig-align='center' width=2100}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}